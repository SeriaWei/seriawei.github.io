$(function(){$(".zone").sortable({placeholder:"sorting",handle:".sort-handle",tolerance:"pointer",connectWith:".zone",stop:function(n,t){var r=t.item.parent(),i;return t.item.data("add")&&$.ajax({type:"POST",url:$("#append-widget-url").val(),dataType:"html",async:!1,data:{ID:t.item.data("id"),ZoneID:$("input.zoneId",this).val(),PageID:$("#pageId").val(),AssemblyName:t.item.data("assemblyname"),ServiceTypeName:t.item.data("servicetypename"),Position:1},success:function(n){t.item.replaceWith(n)}}),i=[],r.find(".widget-design").each(function(n,t){i.push({ID:$(t).data("widgetid"),ZoneId:$(".zoneId",r).val(),Position:n+1})}),$.ajax({type:"POST",url:$("#save-widget-zone-url").val(),dataType:"json",contentType:"application/json;charset=utf-8",async:!1,data:JSON.stringify(i),success:function(){}}),!0}});$(".templates ul li").draggable({helper:"clone",connectToSortable:".zone"});$(document).on("click",".delete",function(){var n=$(this);Easy.ShowMessageBox("提示","确定要删除该组件吗？",function(){$.post(n.data("url"),{ID:n.data("id")},function(n){n&&$("#widget_"+n).parent().remove()},"json")},!0,10)});$(document).on("click",".templates .tool-open",function(){$(this).parent().toggleClass("active")}).on("click",".templates .delete-template",function(){var n=$(this);Easy.ShowMessageBox("提示","确定要删除该模板吗？",function(){$.post(n.data("url"),{Id:n.data("id")},function(n){n&&$("#template_"+n).remove()},"json")},!0,10)}).on("click",".upload-template",function(){$("#template-file").trigger("click")}).on("change","#template-file",function(){$("#template-form").submit()});$(".helper").click(function(){$("#containers").toggleClass($(this).data("class"))});$(window).width()>1600&&$(".templates").addClass("active")});